<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TPCG Collection Record - ä»£ç å®¡æŸ¥æŠ¥å‘Š</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        .score-section {
            text-align: center;
            margin: 30px 0;
        }
        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(#667eea 0% 75%, #e0e0e0 75% 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            position: relative;
        }
        .score-inner {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
        }
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .metric-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }
        .metric-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .metric-score {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        .section {
            margin: 40px 0;
        }
        .section h2 {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
            padding-left: 15px;
        }
        .issue {
            margin: 15px 0;
            padding: 15px;
            border-left: 4px solid;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .critical { 
            border-color: #e74c3c; 
            background: #fee; 
        }
        .medium { 
            border-color: #f39c12; 
            background: #ffeaa7; 
        }
        .minor { 
            border-color: #27ae60; 
            background: #d5f4e6; 
        }
        .issue-title {
            font-weight: bold;
            margin-bottom: 8px;
        }
        .issue-description {
            margin-bottom: 10px;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .good-point {
            background: #d5f4e6;
            border-left: 4px solid #27ae60;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .suggestion {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .file-path {
            font-family: monospace;
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        .tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            margin: 2px;
        }
        .tag-critical { background: #ffebee; color: #c62828; }
        .tag-medium { background: #fff3e0; color: #ef6c00; }
        .tag-minor { background: #e8f5e8; color: #2e7d32; }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            width: 75%;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” ä»£ç å®¡æŸ¥æŠ¥å‘Š</h1>
            <div class="subtitle">TPCG Collection Record - Flutter é¡¹ç›®</div>
            <div class="subtitle">å®¡æŸ¥æ—¶é—´: 2025-01-09</div>
        </div>

        <div class="score-section">
            <div class="score-circle">
                <div class="score-inner">7.5</div>
            </div>
            <h3>æ€»ä½“è¯„åˆ†</h3>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <p>ä»£ç è´¨é‡è‰¯å¥½ï¼Œæœ‰ä¸€äº›æ”¹è¿›ç©ºé—´</p>
        </div>

        <div class="metrics">
            <div class="metric-card">
                <h3>ğŸ—ï¸ ä»£ç è´¨é‡</h3>
                <div class="metric-score">8/10</div>
                <p>æ¶æ„æ¸…æ™°ï¼Œå‘½åè§„èŒƒ</p>
            </div>
            <div class="metric-card">
                <h3>ğŸ”’ å®‰å…¨æ€§</h3>
                <div class="metric-score">7/10</div>
                <p>åŸºæœ¬å®‰å…¨ï¼Œéœ€è¦è¾“å…¥éªŒè¯</p>
            </div>
            <div class="metric-card">
                <h3>âš¡ æ€§èƒ½</h3>
                <div class="metric-score">7/10</div>
                <p>æ€§èƒ½è‰¯å¥½ï¼Œæœ‰ä¼˜åŒ–ç©ºé—´</p>
            </div>
            <div class="metric-card">
                <h3>ğŸ”§ å¯ç»´æŠ¤æ€§</h3>
                <div class="metric-score">8/10</div>
                <p>ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤</p>
            </div>
        </div>

        <div class="section">
            <h2>âœ… ä¼˜ç‚¹</h2>
            <div class="good-point">
                <strong>ğŸ—ï¸ ä¼˜ç§€çš„æ¶æ„è®¾è®¡</strong>
                <p>é‡‡ç”¨äº† MVVM æ¶æ„æ¨¡å¼ï¼Œä½¿ç”¨ Provider è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œä»£ç åˆ†å±‚æ¸…æ™°ï¼ŒèŒè´£åˆ†ç¦»è‰¯å¥½ã€‚</p>
            </div>
            <div class="good-point">
                <strong>ğŸ“¦ æ•°æ®æ¨¡å‹è®¾è®¡</strong>
                <p>ä½¿ç”¨ Freezed ç”Ÿæˆä¸å¯å˜æ•°æ®ç±»ï¼Œæä¾›äº†ç±»å‹å®‰å…¨å’Œä»£ç ç”Ÿæˆï¼Œå‡å°‘äº†æ ·æ¿ä»£ç ã€‚</p>
            </div>
            <div class="good-point">
                <strong>ğŸ“ æ—¥å¿—ç³»ç»Ÿ</strong>
                <p>å®ç°äº†å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿï¼Œæ”¯æŒä¸åŒçº§åˆ«çš„æ—¥å¿—è¾“å‡ºï¼Œä¾¿äºè°ƒè¯•å’Œé—®é¢˜æ’æŸ¥ã€‚</p>
            </div>
            <div class="good-point">
                <strong>ğŸ¨ UI è®¾è®¡</strong>
                <p>ç•Œé¢è®¾è®¡ç°ä»£åŒ–ï¼Œæ”¯æŒæ·±è‰²æ¨¡å¼ï¼Œå“åº”å¼å¸ƒå±€é€‚é…ä¸åŒå±å¹•å°ºå¯¸ã€‚</p>
            </div>
        </div>

        <div class="section">
            <h2>âš ï¸ å‘ç°çš„é—®é¢˜</h2>
            
            <div class="issue critical">
                <div class="issue-title">
                    ğŸ”´ ä¸¥é‡é—®é¢˜
                    <span class="tag tag-critical">Critical</span>
                </div>
                <div class="issue-description">
                    <strong>æ•°æ®åº“æ“ä½œç¼ºä¹äº‹åŠ¡å¤„ç†</strong><br>
                    æ–‡ä»¶: <span class="file-path">lib/services/database_service.dart</span>
                </div>
                <p>åœ¨åˆ é™¤é¡¹ç›®æ—¶ï¼Œå…ˆåˆ é™¤å¡ç‰‡å†åˆ é™¤é¡¹ç›®çš„æ“ä½œæ²¡æœ‰ä½¿ç”¨äº‹åŠ¡ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚</p>
                <div class="code-block">// é—®é¢˜ä»£ç 
Future&lt;int&gt; deleteProject(int id) async {
  final db = await database;
  // å…ˆåˆ é™¤å…³è”çš„å¡ç‰‡
  await db.delete('cards', where: 'project_id = ?', whereArgs: [id]);
  // å†åˆ é™¤é¡¹ç›® - å¦‚æœè¿™é‡Œå¤±è´¥ï¼Œå¡ç‰‡å·²è¢«åˆ é™¤ä½†é¡¹ç›®è¿˜åœ¨
  return await db.delete('projects', where: 'id = ?', whereArgs: [id]);
}</div>
            </div>

            <div class="issue critical">
                <div class="issue-title">
                    ğŸ”´ ä¸¥é‡é—®é¢˜
                    <span class="tag tag-critical">Critical</span>
                </div>
                <div class="issue-description">
                    <strong>ç¼ºä¹è¾“å…¥éªŒè¯</strong><br>
                    æ–‡ä»¶: <span class="file-path">lib/services/database_service.dart</span>
                </div>
                <p>æ•°æ®åº“æ“ä½œæ–¹æ³•ç¼ºä¹è¾“å…¥å‚æ•°éªŒè¯ï¼Œå¯èƒ½å¯¼è‡´ç©ºæŒ‡é’ˆå¼‚å¸¸æˆ–æ— æ•ˆæ•°æ®æ’å…¥ã€‚</p>
            </div>

            <div class="issue medium">
                <div class="issue-title">
                    ğŸŸ¡ ä¸­ç­‰é—®é¢˜
                    <span class="tag tag-medium">Medium</span>
                </div>
                <div class="issue-description">
                    <strong>é‡å¤çš„æ•°æ®åº“æŸ¥è¯¢ä»£ç </strong><br>
                    æ–‡ä»¶: <span class="file-path">lib/services/database_service.dart</span>
                </div>
                <p>åœ¨å¤šä¸ªæ–¹æ³•ä¸­å­˜åœ¨ç›¸ä¼¼çš„æ•°æ®åº“æŸ¥è¯¢å’Œå¯¹è±¡æ„å»ºä»£ç ï¼Œåº”è¯¥æå–ä¸ºé€šç”¨æ–¹æ³•ã€‚</p>
                <div class="code-block">// é‡å¤çš„ PTCGCard æ„å»ºä»£ç å‡ºç°åœ¨å¤šä¸ªæ–¹æ³•ä¸­
return PTCGCard(
  id: maps[i]['id'],
  projectId: maps[i]['project_id'],
  name: maps[i]['name'],
  // ... é‡å¤çš„å­—æ®µæ˜ å°„
);</div>
            </div>

            <div class="issue medium">
                <div class="issue-title">
                    ğŸŸ¡ ä¸­ç­‰é—®é¢˜
                    <span class="tag tag-medium">Medium</span>
                </div>
                <div class="issue-description">
                    <strong>å¼‚å¸¸å¤„ç†ä¸å¤Ÿå®Œå–„</strong><br>
                    æ–‡ä»¶: <span class="file-path">lib/viewmodels/*.dart</span>
                </div>
                <p>ViewModel ä¸­çš„å¼‚å¸¸å¤„ç†ä¸»è¦æ˜¯è®°å½•æ—¥å¿—ï¼Œç¼ºä¹ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤ºæœºåˆ¶ã€‚</p>
            </div>

            <div class="issue minor">
                <div class="issue-title">
                    ğŸŸ¢ è½»å¾®é—®é¢˜
                    <span class="tag tag-minor">Minor</span>
                </div>
                <div class="issue-description">
                    <strong>é­”æ³•æ•°å­—</strong><br>
                    æ–‡ä»¶: <span class="file-path">lib/views/home_page.dart</span>
                </div>
                <p>ä»£ç ä¸­å­˜åœ¨ä¸€äº›é­”æ³•æ•°å­—ï¼Œå¦‚ `limit: 5`ï¼Œåº”è¯¥å®šä¹‰ä¸ºå¸¸é‡ã€‚</p>
            </div>

            <div class="issue minor">
                <div class="issue-title">
                    ğŸŸ¢ è½»å¾®é—®é¢˜
                    <span class="tag tag-minor">Minor</span>
                </div>
                <div class="issue-description">
                    <strong>æ³¨é‡Šä¸å¤Ÿå……åˆ†</strong><br>
                    æ–‡ä»¶: <span class="file-path">lib/views/*.dart</span>
                </div>
                <p>éƒ¨åˆ†å¤æ‚çš„ UI æ„å»ºæ–¹æ³•ç¼ºä¹æ³¨é‡Šè¯´æ˜ï¼Œå½±å“ä»£ç å¯è¯»æ€§ã€‚</p>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ’¡ æ”¹è¿›å»ºè®®</h2>
            
            <div class="suggestion">
                <strong>ğŸ”§ æ·»åŠ æ•°æ®åº“äº‹åŠ¡å¤„ç†</strong>
                <div class="code-block">Future&lt;int&gt; deleteProject(int id) async {
  final db = await database;
  return await db.transaction((txn) async {
    // åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œåˆ é™¤æ“ä½œ
    await txn.delete('cards', where: 'project_id = ?', whereArgs: [id]);
    return await txn.delete('projects', where: 'id = ?', whereArgs: [id]);
  });
}</div>
            </div>

            <div class="suggestion">
                <strong>ğŸ“ æå–æ•°æ®æ˜ å°„æ–¹æ³•</strong>
                <div class="code-block">PTCGCard _mapToCard(Map&lt;String, dynamic&gt; map) {
  return PTCGCard(
    id: map['id'],
    projectId: map['project_id'],
    name: map['name'],
    issueNumber: map['issue_number'],
    // ... å…¶ä»–å­—æ®µæ˜ å°„
  );
}</div>
            </div>

            <div class="suggestion">
                <strong>ğŸ›¡ï¸ æ·»åŠ è¾“å…¥éªŒè¯</strong>
                <div class="code-block">Future&lt;int&gt; insertCard(PTCGCard card) async {
  // éªŒè¯å¿…å¡«å­—æ®µ
  if (card.name.trim().isEmpty) {
    throw ArgumentError('å¡ç‰‡åç§°ä¸èƒ½ä¸ºç©º');
  }
  if (card.acquiredPrice &lt; 0) {
    throw ArgumentError('å…¥æ‰‹ä»·æ ¼ä¸èƒ½ä¸ºè´Ÿæ•°');
  }
  
  final db = await database;
  return await db.insert('cards', card.toMap());
}</div>
            </div>

            <div class="suggestion">
                <strong>ğŸ“± æ”¹è¿›é”™è¯¯å¤„ç†</strong>
                <div class="code-block">class AppError {
  final String message;
  final String? userMessage;
  
  AppError(this.message, {this.userMessage});
}

// åœ¨ ViewModel ä¸­
Future&lt;bool&gt; addCard(PTCGCard card) async {
  try {
    await _databaseService.insertCard(card);
    return true;
  } catch (e) {
    Log.error('æ·»åŠ å¡ç‰‡å¤±è´¥', e);
    // é€šçŸ¥ UI æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    _errorMessage = 'æ·»åŠ å¡ç‰‡å¤±è´¥ï¼Œè¯·é‡è¯•';
    notifyListeners();
    return false;
  }
}</div>
            </div>

            <div class="suggestion">
                <strong>ğŸ¯ å®šä¹‰å¸¸é‡</strong>
                <div class="code-block">class AppConstants {
  static const int recentCardsLimit = 5;
  static const String databaseName = 'tpcg_collection.db';
  static const int databaseVersion = 1;
}</div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ“Š ä»£ç ç»Ÿè®¡</h2>
            <div class="metrics">
                <div class="metric-card">
                    <h3>ğŸ“ æ–‡ä»¶æ•°é‡</h3>
                    <div class="metric-score">24</div>
                    <p>Dart æºæ–‡ä»¶</p>
                </div>
                <div class="metric-card">
                    <h3>ğŸ—ï¸ æ¶æ„å±‚æ¬¡</h3>
                    <div class="metric-score">4</div>
                    <p>Models, Services, ViewModels, Views</p>
                </div>
                <div class="metric-card">
                    <h3>ğŸ” å‘ç°é—®é¢˜</h3>
                    <div class="metric-score">6</div>
                    <p>2ä¸¥é‡ + 2ä¸­ç­‰ + 2è½»å¾®</p>
                </div>
                <div class="metric-card">
                    <h3>ğŸ’¡ æ”¹è¿›å»ºè®®</h3>
                    <div class="metric-score">5</div>
                    <p>å…·ä½“å¯æ‰§è¡Œçš„å»ºè®®</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ¯ æ€»ç»“</h2>
            <p>è¿™æ˜¯ä¸€ä¸ªç»“æ„è‰¯å¥½çš„ Flutter é¡¹ç›®ï¼Œé‡‡ç”¨äº†ç°ä»£åŒ–çš„å¼€å‘æ¨¡å¼å’Œæœ€ä½³å®è·µã€‚ä»£ç æ•´ä½“è´¨é‡è¾ƒé«˜ï¼Œæ¶æ„æ¸…æ™°ï¼Œä½†åœ¨æ•°æ®åº“æ“ä½œçš„å®‰å…¨æ€§å’Œé”™è¯¯å¤„ç†æ–¹é¢è¿˜æœ‰æ”¹è¿›ç©ºé—´ã€‚å»ºè®®ä¼˜å…ˆè§£å†³æ•°æ®åº“äº‹åŠ¡å’Œè¾“å…¥éªŒè¯é—®é¢˜ï¼Œç„¶åé€æ­¥ä¼˜åŒ–ä»£ç é‡å¤å’Œé”™è¯¯å¤„ç†æœºåˆ¶ã€‚</p>
            
            <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #667eea;">
                <strong>æ¨èä¼˜å…ˆçº§ï¼š</strong>
                <ol style="margin-top: 10px;">
                    <li>ğŸ”´ ä¿®å¤æ•°æ®åº“äº‹åŠ¡é—®é¢˜ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰</li>
                    <li>ğŸ”´ æ·»åŠ è¾“å…¥éªŒè¯ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰</li>
                    <li>ğŸŸ¡ é‡æ„é‡å¤ä»£ç ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰</li>
                    <li>ğŸŸ¡ æ”¹è¿›é”™è¯¯å¤„ç†ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰</li>
                    <li>ğŸŸ¢ æ·»åŠ å¸¸é‡å®šä¹‰ï¼ˆä½ä¼˜å…ˆçº§ï¼‰</li>
                </ol>
            </div>
        </div>

        <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 2px solid #eee; color: #7f8c8d;">
            <p>ğŸ“… æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2025-01-09 | ğŸ¤– ä»£ç å®¡æŸ¥åŠ©æ‰‹</p>
        </div>
    </div>
</body>
</html>